<!DOCTYPE html>
<html>

<head>
	<title>box</title>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
	<style>
		body {
			font-family: Monospace;
			background-color: #000;
			color: #fff;
			margin: 0px;
			overflow: hidden;
		}

		#info {
			color: #fff;
			position: absolute;
			top: 10px;
			width: 100%;
			text-align: center;
			z-index: 100;
			display: block;
		}

		#info a,
		.button {
			color: #f00;
			font-weight: bold;
			text-decoration: underline;
			cursor: pointer
		}
	</style>
</head>

<body>
	<div id="info">
	</div>

	<script src="js/three.js"></script>
	<script src="js/OrbitControls.js"></script>

	<script>
		//创建场景
		var scene = new THREE.Scene();
		//scene.fog = new THREE.FogExp2(0x000000, 0.05);

		//创建相机（视野，显示口的宽高比，近裁剪面，远裁剪面）
		var camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 10000);
		//创建渲染器
		var renderer = new THREE.WebGLRenderer();

		renderer.setPixelRatio(window.devicePixelRatio);
		renderer.setSize(window.innerWidth, window.innerHeight);
		renderer.shadowMap.enabled = true;
		renderer.shadowMap.type = THREE.PCFSoftShadowMap;
		renderer.gammaInput = true;
		renderer.gammaOutput = true;
		document.body.appendChild(renderer.domElement);
		//控制器
		var controls = new THREE.OrbitControls(camera, renderer.domElement);

		//灯光
		var light = new THREE.AmbientLight(0xffffff, .1);
		scene.add(light);
		var directionalLight = new THREE.DirectionalLight(0xffaa11, .3);
		scene.add(directionalLight);
		//directionalLight.position.set(0,-10,0)

		var spotLight = new THREE.SpotLight(0xffffff, 1, 100, Math.PI / 12);
		spotLight.position.set(20, 10, -10);
		spotLight.castShadow = true;
		// spotLight.shadow.mapSize.width = 20480;
		// spotLight.shadow.mapSize.height = 20480;
		// spotLight.shadow.camera.near = .1;
		// spotLight.shadow.camera.far = 1;
		// spotLight.shadow.camera.fov = 10;
		scene.add(spotLight);

		//点光1
		var light = new THREE.PointLight(0xff0000, 1, 5,1);
		light.position.set(0, 3, 0);
		scene.add(light);
		var geometry = new THREE.SphereGeometry(.1, 32, 32);
		var material = new THREE.MeshBasicMaterial({
			color: 0xff0000
		});
		var sphere = new THREE.Mesh(geometry, material);
		sphere.position.copy(light.position)
		scene.add(sphere);
		//点光2
		var light = new THREE.PointLight(0x00ffff, 1, 5,1);
		light.position.set(2, 2, 0);
		scene.add(light);
		var geometry = new THREE.SphereGeometry(.1, 32, 32);
		var material = new THREE.MeshBasicMaterial({
			color: 0x00ffff
		});
		var sphere = new THREE.Mesh(geometry, material);
		sphere.position.copy(light.position)
		scene.add(sphere);

		var spotLightHelper = new THREE.SpotLightHelper(spotLight);
		scene.add(spotLightHelper);
		//辅助
		var helper = new THREE.DirectionalLightHelper(directionalLight, 15);
		//scene.add(helper);
		var size = 20;
		var divisions = 30;
		var gridHelper = new THREE.GridHelper(size, divisions);
		//scene.add(gridHelper);
		var axesHelper = new THREE.AxesHelper(5);
		scene.add(axesHelper);

		//天空盒子
		var cubeTextureLoader = new THREE.CubeTextureLoader();
		cubeTextureLoader.setPath('img/');
		var cubeTexture = cubeTextureLoader.load([
			'px.jpg', 'nx.jpg',
			'py.jpg', 'ny.jpg',
			'pz.jpg', 'nz.jpg',
		]);
		var cubeShader = THREE.ShaderLib['cube'];
		cubeShader.uniforms['tCube'].value = cubeTexture;
		var skyBoxMaterial = new THREE.ShaderMaterial({
			fragmentShader: cubeShader.fragmentShader,
			vertexShader: cubeShader.vertexShader,
			uniforms: cubeShader.uniforms,
			side: THREE.BackSide
		});
		var skyBox = new THREE.Mesh(new THREE.BoxBufferGeometry(10000, 10000, 10000), skyBoxMaterial);
		//scene.add(skyBox);

		//圆形顶
		var geometry = new THREE.SphereBufferGeometry(5000, 32, 32);
		var texture1 = new THREE.TextureLoader().load("img/timg3.jpg");
		texture1.wrapS = texture1.wrapT = THREE.RepeatWrapping
		texture1.repeat.set(10, 10);
		var material = new THREE.MeshPhongMaterial({
			color: 0xffffff,
			side: THREE.DoubleSide,
			map: texture1
		});
		var sphere = new THREE.Mesh(geometry, material);
		scene.add(sphere);
		//黑色屏幕
		var geometry = new THREE.CylinderGeometry(15, 15, 5, 32, 10, true, -Math.PI / 2, Math.PI / 2);
		var material = new THREE.MeshPhongMaterial({
			color: 0x333333,
			shininess: 1000,
			side: THREE.DoubleSide
		});
		var cylinder = new THREE.Mesh(geometry, material);
		cylinder.position.set(0, 4, 0)
		scene.add(cylinder);
		light.target = cylinder;

		//方形底盘
		// 		var geometry = new THREE.PlaneGeometry( 20, 20, 32 );
		// var material = new THREE.MeshBasicMaterial( {color: 0x999999, side: THREE.DoubleSide} );
		// var plane = new THREE.Mesh( geometry, material );
		// plane.rotation.set(Math.PI/2,0,0)
		// scene.add( plane );

		var texture = new THREE.TextureLoader().load("img/timg1.jpeg");
		texture.wrapS = texture.wrapT = THREE.RepeatWrapping;
		texture.repeat.set(10, 10);
		//圆形底盘
		var geometry = new THREE.CircleGeometry(5000, 32);
		var material = new THREE.MeshPhongMaterial({
			color: 0x99dddd,
			shininess: 3000,
			//	map:texture,
			side: THREE.DoubleSide
		});
		var circle = new THREE.Mesh(geometry, material);
		circle.rotation.set(Math.PI / 2, 0, 0)
		circle.receiveShadow = true;
		circle.castShadow = true;
		scene.add(circle);
		//circle.position.set(0,-30,0)

		//正方体
		var geometry = new THREE.BoxGeometry(1, 1, 1);
		var material = new THREE.MeshLambertMaterial({
			color: 0xff5555
		});
		var cube = new THREE.Mesh(geometry, material);
		cube.castShadow = true;

		//菱形
		var tubeGeo = new THREE.OctahedronGeometry(1, 5);
		var tubeMate = new THREE.MeshPhongMaterial({
			color: 0xffffff,
			shininess: 3000,
		});
		var tubeMesh = new THREE.Mesh(tubeGeo, tubeMate);
		tubeMesh.castShadow = true;
		tubeMesh.position.set(0, 1, -2);
		//组
		var group = new THREE.Group();
		group.position.set(2, 3, 0);
		group.add(cube);
		group.add(tubeMesh);
		scene.add(group)




		camera.position.z = -10;
		camera.position.y = 8;
		camera.position.x = -12;

		directionalLight.position.set(0, 10, 0)

		//console.log(directionalLight.position)
let x=0;
		var render = function () {
			requestAnimationFrame(render);
			cube.rotation.x += 0.01;
			// group.rotation.y += 0.01;
			// group.scale.set(2,.5,.5)
			
			light.position.x+=.02
			controls.update();

			renderer.render(scene, camera);

		};

		render();
	</script>

</body>

</html>